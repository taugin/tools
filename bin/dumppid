echo [Logging...] ARGS : [$*]
echo [Logging...] 等待设备连接...
adb wait-for-device
#获取顶层Activity包名
adb shell dumpsys activity top | grep "ACTIVITY" > .activity.tmp

TOP_ACTIVITY=""
while read line
do
TOP_ACTIVITY=$line
done < .activity.tmp
rm .activity.tmp
COMPONENT_NAME=$(echo $TOP_ACTIVITY | awk -F" " {'print $2'})

PACKAGE_NAME=$(echo $COMPONENT_NAME | awk -F"/" {'print $1'})

ACTIVITY_NAME=$(echo $COMPONENT_NAME | awk -F"/" {'print $2'})

#echo $PACKAGE_NAME

#获取顶层Activity用户名
USER_NAME_ARRAY=($(adb shell ps -A | grep $PACKAGE_NAME | awk {'print $1'}))
USER_NAME=${USER_NAME_ARRAY[0]}
#echo $USER_NAME

echo [Logging...] $USER_NAME      $PACKAGE_NAME
echo

while true
do
    echo [Logging...]  $(date +"%Y:%m:%d %H:%M:%S")
    adb wait-for-device
	#echo [Logging...] Activity : $ACTIVITY_NAME
    adb shell ps -A | grep $USER_NAME
    if [ "$1" != "loop" ]; then
        break;
    else
        echo
        sleep 1
    fi
done